from selenium import webdriver
from selenium import webdriver
from selenium import webdriver
pacman::p_load(data.table)
pacman::p_load(data.table, openxlsx)
AR_schools <- read.xlsx("arkansas_schools_with_FIPS.xlsx")
View(AR_schools)
corrected_data25_q1 <- craft_data_with_identifiers %>%
mutate(`931` = case_when(`First Name` == "Terrill" & `Last Name` == "Dodd" ~ 1,
`First Name` == "Amanda" & `Last Name` == "Greer" ~ 1,
`First Name` == "Natalie" & `Last Name` == "Akers" ~ 1,
`First Name` == "Makenna" & `Last Name` == "McGee" ~ 1,
`First Name` == "Kevin" & `Last Name` == "Shackleford" ~ 1,
`First Name` == "Austin" & `Last Name` == "Shell" ~ 1,
`First Name` == "Logan" & `Last Name` == "Jones" ~ 1,
`First Name` == "Libby" & `Last Name` == "Maple" ~ 1,
`First Name` == "Ryanna" & `Last Name` == "Warren" ~ 1,
`First Name` == "Skyla" & `Last Name` == "Miller" ~ 1,
`First Name` == "Mackenzie" & `Last Name` == "Angel" ~ 1,
`First Name` == "Breanna" & `Last Name` == "Williams" ~ 1,
`First Name` == "Gabriella" & `Last Name` == "Crites" ~ 1,
`First Name` == "Kyra" & `Last Name` == "Moyers" ~ 1,
`First Name` == "Emily" & `Last Name` == "Slayton" ~ 1,
`First Name` == "Brittany" & `Last Name` == "Smith" ~ 1,
`First Name` == "Bailey" & `Last Name` == "Honeycutt" ~ 1,
TRUE ~ `931`),
`931` = case_when(`First Name` == "Terrill" & `Last Name` == "Dodd" ~ 1,
`First Name` == "Amanda" & `Last Name` == "Greer" ~ 1,
`First Name` == "Natalie" & `Last Name` == "Akers" ~ 1,
`First Name` == "Makenna" & `Last Name` == "McGee" ~ 1,
`First Name` == "Kevin" & `Last Name` == "Shackleford" ~ 1,
`First Name` == "Austin" & `Last Name` == "Shell" ~ 1,
`First Name` == "Logan" & `Last Name` == "Jones" ~ 1,
`First Name` == "Libby" & `Last Name` == "Maple" ~ 1,
`First Name` == "Ryanna" & `Last Name` == "Warren" ~ 1,
`First Name` == "Skyla" & `Last Name` == "Miller" ~ 1,
`First Name` == "Mackenzie" & `Last Name` == "Angel" ~ 1,
`First Name` == "Breanna" & `Last Name` == "Williams" ~ 1,
`First Name` == "Gabriella" & `Last Name` == "Crites" ~ 1,
`First Name` == "Kyra" & `Last Name` == "Moyers" ~ 1,
`First Name` == "Emily" & `Last Name` == "Slayton" ~ 1,
`First Name` == "Brittany" & `Last Name` == "Smith" ~ 1,
`First Name` == "Bailey" & `Last Name` == "Honeycutt" ~ 1,
TRUE ~ `931`))
# Chunk 1: setup
rm(list = ls())
pacman::p_load(tidyverse)
# Chunk 2
Craft_data_24_Q4_will <- read_csv("highlighted_wips copy.csv", col_names = FALSE)
rm(list = ls())
pacman::p_load(tidyverse)
Craft_data_24_Q4_will <- read_csv("highlighted_wips copy.csv", col_names = FALSE)
# Chunk 1
# clear environment and load required packages
rm(list = ls())
library(data.table)
library(dplyr)
library(readr) # needed for read_csv used later
# Chunk 2
al_data <- fread("https://lehd.ces.census.gov/data/lodes/LODES8/al/wac/al_wac_S000_JT02_2022.csv.gz")
# Keep w_geocode (location), C000, and all CFA* columns
al_data <- al_data[, c("w_geocode", "C000", grep("^CFA", names(al_data), value = TRUE)), with = FALSE]
# Chunk 3
al_crosswalk <- fread("https://lehd.ces.census.gov/data/lodes/LODES8/al/al_xwalk.csv.gz")
al_crosswalk <- al_crosswalk[, .(tabblk2020, trct, trctname, cbsa, cbsaname)]
# Chunk 4
al_crosswalked <- al_data[al_crosswalk, on = c(w_geocode = "tabblk2020")]
library(data.table)
lodes_by_block <- fread("data.zip/LODES_data_by_block.csv", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
rm(list = ls())
library(data.table)
lodes_by_block <- fread("data/LODES_data_by_block.csv", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block[,  `:=` (w_geocode = sprintf("%015s", w_geocode),
trct = sprintf("%011s", trct),
cbsa = sprintf("%005s", cbsa)
)]
# Summarize by tract, then filter to C000 (total employees) > 100
lodes_by_tract <- lodes_by_block[, `:=` (tract_fips = substr(w_geocode, 1, 11),
county_fips = substr(w_geocode, 1, 5))][C000 >= 100]
setnames(lodes_by_tract, old = c("C000", "CFA01", "CFA02", "CFA03", "CFA04", "CFA05"   #, "CD01", "CD02", "CD03", "CD04"
),
new = c("total_jobs", "Employees_firms_0_1_yrs", "employees_firms_2_3_yrs", "employees_firms_4_5_yrs", "employees_firms_6_10_yrs", "employees_firms_11_plus_yrs"
#, "employees_less_than_high_school", "employees_high_school_grad", "employees_some_college", "employees_bachelor_plus"
))
tract_data <- fread("data/merged_tract_data.csv", colClasses = list(
"character" = "Census Tract FIPS code",
"character" = "CBSA.Code"
))
merged_tract_data <- lodes_by_tract[tract_data, on = .(tract_fips = `Census Tract FIPS code`, cbsaname = CBSA.Title, cbsa = CBSA.Code, year = Year), nomatch = NULL]
yfes_by_tract <- merged_tract_data[
, .(
total_jobs = sum(total_jobs, na.rm = TRUE),
young_firm_employees = sum(
Employees_firms_0_1_yrs,
employees_firms_2_3_yrs,
employees_firms_4_5_yrs,
na.rm = TRUE
),
yfes = sum(
Employees_firms_0_1_yrs,
employees_firms_2_3_yrs,
employees_firms_4_5_yrs,
na.rm = TRUE
) / sum(total_jobs, na.rm = TRUE),
`Metropolitan/Micropolitan.Statistical.Area` = `Metropolitan/Micropolitan.Statistical.Area`,
population = population,
cbsaname,
cbsa
),
by = .(tract_fips, year)
]#[cbsaname != ""] #removing all census tracts that are not in a CBSA
# National average YFES generally
yfes_by_tract <- yfes_by_tract[, Natl_avg_yfes := sum(young_firm_employees, na.rm = TRUE) / sum(total_jobs, na.rm = TRUE)]
yfes_by_tract <- yfes_by_tract[, Natl_yfes_by_cbsa_type := sum(young_firm_employees, na.rm = TRUE) / sum(total_jobs, na.rm = TRUE), by = .(`Metropolitan/Micropolitan.Statistical.Area`)]
yfes_by_tract[, `:=` (above_natl_avg = fifelse(yfes > Natl_avg_yfes, 1, 0),
above_natl_avg_by_cbsa_type = fifelse(yfes > Natl_yfes_by_cbsa_type, 1, 0))]
pct_above_natl_average <- yfes_by_tract[,
.(
population_above_natl_avg = sum(population * above_natl_avg, na.rm = TRUE),
population_above_natl_avg_by_cbsa_type = sum(population * above_natl_avg_by_cbsa_type, na.rm = TRUE),
total_population = sum(population, na.rm = TRUE)
),
by = .(`cbsaname`, year)
]
pct_above_natl_average[, `:=` (pct_above_natl_avg_simple = population_above_natl_avg / total_population,
pct_above_natl_avg_by_cbsa_type = population_above_natl_avg_by_cbsa_type / total_population)]
View(pct_above_natl_average)
View(yfes_by_tract)
pct_above_natl_average <- yfes_by_tract[,
`:=` (
population_above_natl_avg = sum(population * above_natl_avg, na.rm = TRUE),
population_above_natl_avg_by_cbsa_type = sum(population * above_natl_avg_by_cbsa_type, na.rm = TRUE),
total_population = sum(population, na.rm = TRUE)
),
by = .(`cbsaname`, year)
]
pct_above_natl_average[, `:=` (pct_above_natl_avg_simple = population_above_natl_avg / total_population,
pct_above_natl_avg_by_cbsa_type = population_above_natl_avg_by_cbsa_type / total_population)]
# Chunk 1
rm(list = ls())
library(data.table)
lodes_by_block <- fread("data/LODES_data_by_block.csv", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block <- fread("data/LODES_data_by_block.csv", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
setwd("~/Documents/Pulse Projects/Entrepreneurship_Metrics/Inclusive_Growth_Score")
# Chunk 1
rm(list = ls())
library(data.table)
lodes_by_block <- fread("data/LODES_data_by_block.csv", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block[,  `:=` (w_geocode = sprintf("%015s", w_geocode),
trct = sprintf("%011s", trct),
cbsa = sprintf("%005s", cbsa)
)]
# Summarize by tract, then filter to C000 (total employees) > 100
lodes_by_tract <- lodes_by_block[, `:=` (tract_fips = substr(w_geocode, 1, 11),
county_fips = substr(w_geocode, 1, 5))][C000 >= 100]
setnames(lodes_by_tract, old = c("C000", "CFA01", "CFA02", "CFA03", "CFA04", "CFA05"   #, "CD01", "CD02", "CD03", "CD04"
),
new = c("total_jobs", "Employees_firms_0_1_yrs", "employees_firms_2_3_yrs", "employees_firms_4_5_yrs", "employees_firms_6_10_yrs", "employees_firms_11_plus_yrs"
#, "employees_less_than_high_school", "employees_high_school_grad", "employees_some_college", "employees_bachelor_plus"
))
# Chunk 2
tract_data <- fread("data/merged_tract_data.csv", colClasses = list(
"character" = "Census Tract FIPS code",
"character" = "CBSA.Code"
))
merged_tract_data <- lodes_by_tract[tract_data, on = .(tract_fips = `Census Tract FIPS code`, cbsaname = CBSA.Title, cbsa = CBSA.Code, year = Year), nomatch = NULL]
yfes_by_tract <- merged_tract_data[
, .(
total_jobs = sum(total_jobs, na.rm = TRUE),
young_firm_employees = sum(
Employees_firms_0_1_yrs,
employees_firms_2_3_yrs,
employees_firms_4_5_yrs,
na.rm = TRUE
),
yfes = sum(
Employees_firms_0_1_yrs,
employees_firms_2_3_yrs,
employees_firms_4_5_yrs,
na.rm = TRUE
) / sum(total_jobs, na.rm = TRUE),
`Metropolitan/Micropolitan.Statistical.Area` = `Metropolitan/Micropolitan.Statistical.Area`,
population = population,
cbsaname,
cbsa
),
by = .(tract_fips, year)
]#[cbsaname != ""] #removing all census tracts that are not in a CBSA
# National average YFES generally
yfes_by_tract <- yfes_by_tract[, Natl_avg_yfes := sum(young_firm_employees, na.rm = TRUE) / sum(total_jobs, na.rm = TRUE)]
yfes_by_tract <- yfes_by_tract[, Natl_yfes_by_cbsa_type := sum(young_firm_employees, na.rm = TRUE) / sum(total_jobs, na.rm = TRUE), by = .(`Metropolitan/Micropolitan.Statistical.Area`)]
yfes_by_tract[, `:=` (above_natl_avg = fifelse(yfes > Natl_avg_yfes, 1, 0),
above_natl_avg_by_cbsa_type = fifelse(yfes > Natl_yfes_by_cbsa_type, 1, 0))]
pct_above_natl_average <- yfes_by_tract[,
`:=` (
population_above_natl_avg = sum(population * above_natl_avg, na.rm = TRUE),
population_above_natl_avg_by_cbsa_type = sum(population * above_natl_avg_by_cbsa_type, na.rm = TRUE),
total_population = sum(population, na.rm = TRUE)
),
by = .(`cbsaname`, year)
]
pct_above_natl_average[, `:=` (pct_above_natl_avg_simple = population_above_natl_avg / total_population,
pct_above_natl_avg_by_cbsa_type = population_above_natl_avg_by_cbsa_type / total_population)]
View(merged_tract_data)
View(pct_above_natl_average)
final_dat <- pct_above_natl_average[]
fwrite(final_dat, "data/yfes_and_pct_above_natl_avg_by_tract.csv")
lodes_by_block <- fread("data/LODES_data_by_block.csv.zip", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block <- fread("data/LODES_data_by_block.csv.zip", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block <- fread("data/LODES_data_by_block.zip", colClasses = list(
"character" = "w_geocode",
"character" = "trct",
"character" = "cbsa"
))
lodes_by_block <- fread(
unz("data/LODES_data_by_block.csv.zip", "LODES_data_by_block.csv"),
colClasses = list(
character = c("w_geocode", "trct", "cbsa")
)
)
# Zip the data/ folder back into data.zip
if (dir.exists("data")) {
zip(zipfile = "data.zip", files = "data")
}
